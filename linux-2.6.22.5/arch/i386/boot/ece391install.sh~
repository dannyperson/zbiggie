#!/bin/sh
#
# Created by Andrew Ofisher for ECE 391 - Fall 2007
#
# This script copies bzImage and vmlinux to 
# /workdir/source/linux-$(KERNEL-VERSION)/ for use by gdb and QEMU
#
# Arguments:
#      $1 - kernel version
#      $2 - bzImage file
#      $3 - vmlinux file
#

verify () {
	if [ ! -f "$1" ]; then
		echo ""                                                   1>&2
		echo " *** Missing file: $1"                              1>&2
		echo ' *** You need to run "make" before "make install".' 1>&2
		echo ""                                                   1>&2
		exit 1
 	fi
}

# Make sure the files actually exist
verify "$2"
verify "$3"

cat $2 > /workdir/source/linux-$1/
cat $3 > /workdir/source/linux-$1/
